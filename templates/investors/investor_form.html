{% extends 'investors/base.html' %}

{% block title %}{% if object %}Edit{% else %}Add{% endif %} Investor - Investor Platform{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <div class="card">
                <div class="card-header">
                    <h4 class="mb-0"><i class="bi bi-person-plus"></i> {% if object %}Edit{% else %}Add New{% endif %} Investor</h4>
                </div>
                <div class="card-body">
                    <form method="post">
                        {% csrf_token %}
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="{{ form.full_name.id_for_label }}" class="form-label">{{ form.full_name.label }} <span class="text-danger">*</span></label>
                                {{ form.full_name }}
                                {% if form.full_name.errors %}
                                    <div class="text-danger small">{{ form.full_name.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-6">
                                <label for="{{ form.email.id_for_label }}" class="form-label">{{ form.email.label }} <span class="text-danger">*</span></label>
                                {{ form.email }}
                                {% if form.email.errors %}
                                    <div class="text-danger small">{{ form.email.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-6">
                                <label for="{{ form.mobile.id_for_label }}" class="form-label">{{ form.mobile.label }} <span class="text-danger">*</span></label>
                                {{ form.mobile }}
                                {% if form.mobile.errors %}
                                    <div class="text-danger small">{{ form.mobile.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-6">
                                <label for="{{ form.dob.id_for_label }}" class="form-label">{{ form.dob.label }} <span class="text-danger">*</span></label>
                                {{ form.dob }}
                                {% if form.dob.errors %}
                                    <div class="text-danger small">{{ form.dob.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-12">
                                <label for="{{ form.address.id_for_label }}" class="form-label">{{ form.address.label }} <span class="text-danger">*</span></label>
                                {{ form.address }}
                                {% if form.address.errors %}
                                    <div class="text-danger small">{{ form.address.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-6">
                                <label for="{{ form.pan.id_for_label }}" class="form-label">{{ form.pan.label }} <span class="text-danger">*</span></label>
                                {{ form.pan }}
                                {% if form.pan.errors %}
                                    <div class="text-danger small">{{ form.pan.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-6">
                                <label for="{{ form.aadhaar.id_for_label }}" class="form-label">{{ form.aadhaar.label }} <span class="text-danger">*</span></label>
                                {{ form.aadhaar }}
                                {% if form.aadhaar.errors %}
                                    <div class="text-danger small">{{ form.aadhaar.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-6">
                                <label for="{{ form.investment_capacity.id_for_label }}" class="form-label">{{ form.investment_capacity.label }}</label>
                                {{ form.investment_capacity }}
                                <small class="form-text text-muted">Auto-assigns Group A (>1Cr) or Group B (â‰¤1Cr)</small>
                                {% if form.investment_capacity.errors %}
                                    <div class="text-danger small">{{ form.investment_capacity.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-6">
                                <label for="{{ form.group.id_for_label }}" class="form-label">{{ form.group.label }} <span class="text-danger">*</span></label>
                                {{ form.group }}
                                <small class="form-text text-muted">Auto-assigned based on investment capacity</small>
                                {% if form.group.errors %}
                                    <div class="text-danger small">{{ form.group.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-4">
                                <label for="{{ form.assigned_team_member.id_for_label }}" class="form-label">{{ form.assigned_team_member.label }}</label>
                                {{ form.assigned_team_member }}
                                {% if form.assigned_team_member.errors %}
                                    <div class="text-danger small">{{ form.assigned_team_member.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-8">
                                <label for="{{ form.family_head.id_for_label }}" class="form-label">
                                    <i class="bi bi-people"></i> {{ form.family_head.label }}
                                </label>
                                {{ form.family_head }}
                                <small class="form-text text-muted">
                                    Select a primary investor (family head) to link this investor as a family member. Leave empty if this is a primary investor.
                                </small>
                                {% if form.family_head.errors %}
                                    <div class="text-danger small">{{ form.family_head.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="mt-4">
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-check-circle"></i> Save
                            </button>
                            <a href="{% url 'investors:investor_list' %}" class="btn btn-secondary">
                                <i class="bi bi-x-circle"></i> Cancel
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Add Bootstrap classes to form fields
    document.addEventListener('DOMContentLoaded', function() {
        const inputs = document.querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
            if (!input.classList.contains('form-control') && !input.classList.contains('form-select')) {
                if (input.tagName === 'SELECT') {
                    input.classList.add('form-select');
                } else if (input.tagName === 'TEXTAREA') {
                    input.classList.add('form-control');
                } else {
                    input.classList.add('form-control');
                }
            }
        });
    });
</script>
{% endblock %}

